{"name":"Exercício Aula 10","tagline":"Esta página foi criada para exibir os resultados relativos ao exercício da aula 10. Os comandos utlizados no RStudio bem como os resultados obtidos, serão apresentados a seguir.","body":"**ENUNCIADO DA QUESTÃO**\r\n\r\n1) Considere o conjunto de dados de Mimulus, já usado em aulas anteriores. Usando o mapa que você construiu anteriormente com o OneMap, faça mapeamento por intervalo e por intervalo composto para localizar QTL’s para uma das características presentes no conjunto de dados (escolha a que julgar mais interessante).\r\n\r\n- Determine o limiar para rejeitar H0 e apresente os resultados de forma gráfica e em tabelas de forma semelhante aos artigos publicados na área.\r\n- Use o software R/qtl, verificando no tutorial do OneMap como exportar o mapa construído para o formato do R/qtl. Use o Fórum para resolver suas dúvidas.\r\n- O exercício pode ser feito em grupo, pela mesma equipe que fez o mapa genético.\r\n- Apresente os resultados em um arquivo html, da mesma forma que para o mapa de Mimulus.\r\n\r\nSeguindo a orientação do enunciado da questão, o exercício foi elaborado em parceria com a aluna Thaís Fernanda Godoy.\r\nA seguir, serão apresentados os comandos utilizados no RStudio e posteriormente, os resultados obtidos (comentados).\r\n\r\n_**COMANDOS UTILIZADOS NA ANÁLISE DOS DADOS (MIMULUS)**_\r\n\r\n```\r\nlibrary(qtl)\r\n\r\narquivo<-read.cross(\"mm\",dir=\"C:\\\\Users\\\\Usuario\\\\Desktop\\\\BIOMETRIA\",file=\"m_feb06.raw\",mapfile=\"mapa_onemap_total.map\")\r\n\r\n# Por intervalo\r\narquivo<-calc.genoprob(arquivo, step=1)\r\n\r\nout.em<-scanone(arquivo)\r\n\r\noperm <- scanone(arquivo, method=\"hk\", n.perm=1000)\r\nsummary(operm)\r\nplot(operm, col=\"white\")\r\nabline(v=3.86, col=\"red\", lty=3, lwd=3)\r\n\r\nplot(out.em, chr=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14), ylab=\"LOD score\", xlab=\"Chromosome\",\r\n     ylim=c(0,5))\r\nadd.threshold(out.em, chr=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14), perms=operm, alpha=0.05, col=\"blue\", lty=3)\r\n\r\narquivo<-sim.geno(arquivo, step=1)\r\neffectscan(arquivo, chr=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14), ylab=\"Effect\", xlab=\"Chromosome\")\r\n\r\nout.hk <- scanone(arquivo, method=\"hk\")\r\nplot(out.em, out.hk, chr=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14), col=c(\"blue\",\"red\"), ylab=\"LOD score\")\r\n\r\n\r\nplot(out.hk - out.em, chr=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14), ylim=c(-0.5, 1.0),ylab=expression(LOD[HK] - LOD[EM]))\r\nabline(h=0, lty=3)\r\n\r\n#Rodar essa parte\r\nLOD<-scanone(arquivo, chr=c(7))\r\nLOD\r\n\r\nefeitos<-effectscan(arquivo, chr=c(7))\r\nefeitos\r\n\r\nend<-data.frame(LOD, efeitos)\r\n\r\n# Por intervalo composto\r\n\r\narquivo<-calc.genoprob(arquivo,step=1,error.prob=0.001)\r\nout<-scanone(arquivo)\r\n\r\n#Identificação do marcador próximo\r\n\r\nmar <- find.marker(arquivo , 7, 30) #está correto o Lod\r\n\r\ng <- pull.geno(arquivo)[,mar]\r\nsum(is.na(g))\r\n\r\n#Imputando os dados faltantes\r\ng <- pull.geno(fill.geno(arquivo))[,mar]\r\nsum(is.na(g))\r\n\r\n# F2 matriz\r\n\r\ng <- cbind(as.numeric(g==1), as.numeric(g==2))\r\n\r\nout.ag <- scanone(arquivo, addcovar=g)\r\n\r\nplot(out, out.ag, chr=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14),col=c(\"blue\", \"red\"), ylab=\"LOD score\")\r\nadd.threshold(out.ag, perms=operm, alpha=0.05, col=\"blue\",lty=3.76)\r\n\r\nstrat <- (ntyped(arquivo) > 100)\r\noperm.ag <- scanone(arquivo, addcovar=g, chr=-7,perm.strata=strat, n.perm=100)\r\n\r\nsummary(operm.ag, alpha=c(0.2, 0.05))\r\n\r\n#\r\nsummary(out.ag, perms=operm.ag, alpha=0.2, pvalues=TRUE)\r\n#\r\nout.ig <- scanone(arquivo, addcovar=g, intcovar=g)\r\n#\r\nplot(out.ig - out.ag, chr=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14),ylab=\"interaction LOD score\")\r\nadd.threshold(out.ag, perms=operm, alpha=0.05, col=\"blue\",lty=3)\r\n#\r\n\r\nout.cim.20 <- cim(arquivo, n.marcovar=3, window=20)\r\nout.cim.40 <- cim(arquivo, n.marcovar=3, window=40)\r\nout.cim.inf <- cim(arquivo, n.marcovar=3, window=Inf)\r\n#\r\nchr <- c(6,7,8,10,11)#\r\npar(mfrow=c(3,1))\r\nplot(out, out.cim.20, chr=chr, ylab=\"LOD score\",col=c(\"blue\", \"red\"), main=\"window = 20 cM\")\r\nadd.cim.covar(out.cim.20, chr=chr, col=\"green\")\r\n\r\nplot(out, out.cim.40, chr=chr, ylab=\"LOD score\",col=c(\"blue\", \"red\"), main=\"window = 40 cM\")\r\nadd.cim.covar(out.cim.40, chr=chr, col=\"green\")\r\n\r\nplot(out, out.cim.inf, chr=chr, ylab=\"LOD score\",col=c(\"blue\", \"red\"), main=\"window = Inf\")\r\nadd.cim.covar(out.cim.inf, chr=chr, col=\"green\")\r\n\r\n```\r\n\r\n**RESULTADOS**\r\n\r\nOs resultados serão apresentados em ordem e comentados. \r\n\r\n**01) MAPEAMENTO POR INTERVALO (PADRÃO)**\r\n\r\na) Determinação do limiar do LOD _score_\r\nComo visto em aulas anteriores da disciplina de Biometria de Marcadores Genéticos, a análise de permutação pode ser utilizada para determinação do limiar do LOD _score_. Sendo assim, permutações (100 vezes) com alfa de 20% e 5% foram testadas, de acordo com o método proposto por Haley-Knott. Com o alfa de 20% foi obtido um LOD _score_ de 3,24 e com um alfa de 5% foi obtido um LOD _score_ de 3,76. O gráfico com os valores obtidos nas permutações pode ser visualizado no gráfico a seguir. A linha vermelha indica o LOD _score_ para o alfa de 5%.\r\n\r\n![Gráfico 01 - Estimação do LOD score (limiar)](https://cloud.githubusercontent.com/assets/12286650/8244957/142f7c72-15fe-11e5-93ea-3dc6539c5e33.jpeg)\r\n\r\nb) Com base nos grupos de ligações montados em exercício anterior, o efeito da aditividade e o efeito da dominância foram estimados e plotados, de todos os indivíduos entre os marcadores que flanqueiam os grupos. O gráfico pode ser observado a seguir:\r\n\r\n![Gráfico 02 - Efeito da aditividade e dominância](https://cloud.githubusercontent.com/assets/12286650/8245223/b8bbea20-1601-11e5-8b74-12c3ad3c59cf.jpeg)\r\n\r\nc) Os valores dos LODs foram plotados por intervalo (seguindo o mapeamento por intervalo padrão) e o gráfico pode ser observado a seguir. Em azul, a linha pontilhada representa o valor do limiar do LOD _score_.\r\n\r\n![Gráfico 03 - LOD score mapeamento por intervalo](https://cloud.githubusercontent.com/assets/12286650/8245277/73577340-1602-11e5-9733-4b590a2de835.jpeg)\r\n\r\nd) Os valores de LOD foram ainda comparados a partir daqueles estimados pelo mapeamento por intervalo padrão bem como, daqueles estimados pela regressão empregada de acordo com o método de Haley-Knott. Ver gráfico a seguir:\r\n\r\n![Gráfico 04 - Valores de LOD pelo mapeamento por intervalo e pelo método de Haley-Knott](https://cloud.githubusercontent.com/assets/12286650/8245323/00acdde8-1603-11e5-8041-a25158b91a65.jpeg)\r\n\r\ne) Por fim, foi plotado ainda um gráfico apresentando a diferença entre os valores de LOD relatados anteriormente. As diferenças foram plotadas por grupo de ligação. Ver gráfico 05 a seguir.\r\n\r\n![Gráfico 05 - Diferenças entre os LODs.](https://cloud.githubusercontent.com/assets/12286650/8245346/77d1a318-1603-11e5-9737-38e92d0a8d4d.jpeg)\r\n\r\n**Comentários gerais**\r\n\r\nCom base nos gráficos apresentados é possível inferir que nenhum QTL foi mapeado com LOD superior ao limiar de 3,76. Vale lembrar que todos os gráficos foram plotados considerando os grupos de ligação como \"cromossomos\". \r\n\r\n**02) MAPEAMENTO POR INTERVALO COMPOSTO**\r\n\r\nNo mapeamento por intervalo composto, os resultados serão apresentados na mesma lógica anterior entretanto, seguirão o padrão de análise e resposta do mapeamento por intervalo composto.\r\n\r\na) Na primeira etapa, os valores de LOD _score_ para a análise dos dados _MIMULUS_ foram plotados com covariáveis e com uma covariável aditiva para os 14 grupos (representados como cromossomos). No gráfico a seguir, os valores com covariáveis estão plotados em azul e os com covariável aditiva estão plotados em vermelho.\r\n\r\nO limiar do LOD _score_ foi estimado também a partir de análise de permutação (proposta por Haley-Knott) com alfa de 20% e 5%. Com alfa de 20%, foi obtido um LOD _score_ de 3,45 e com alfa de 5%, um LOD _score_ de 4,12. \r\n\r\n![Gráfico 06 - Valores de LOD score com covariáveis](https://cloud.githubusercontent.com/assets/12286650/8245415/adee94d2-1604-11e5-8ab1-f1d726058229.jpeg)\r\n\r\nNeste gráfico é possível perceber um intervalo acima do limiar no cromossomo (grupo) 12.\r\n\r\nb) Nesta etapa, um gráfico foi plotado com os valores de interação entre os valores de LOD _score_ bem como, os respectivos intervalos nos grupos de ligação. Ver gráfico a seguir.\r\n\r\n![Gráfico 07 - Interação dos valores LOD score.](https://cloud.githubusercontent.com/assets/12286650/8245544/2fa2bc3c-1606-11e5-9b06-eb08633182db.jpeg)\r\n\r\nNeste gráfico é possível perceber um intervalo com valor superior ao limiar de interação de LOD _score_.\r\n\r\nc) Finalmente, são apresentados os resultados do mapeamento por intervalo composto para os dados de _Mimulus_. São apresentadas três opções de tamanho da janela. Os gráficos apresentados englobam ainda os resultados dos dois tipos de mapeamento (intervalo e intervalo composto). Em azul, os resultados do mapeamento por intervalo (padrão); em vermelho, os resultados por mapeamento por intervalo composto. Ver gráficos a seguir.\r\n\r\n![Gráfico 08 - Resultados dos mapeamentos](https://cloud.githubusercontent.com/assets/12286650/8245611/1144c374-1607-11e5-8c5a-3996d9cbbcfc.jpeg)\r\n\r\n**Comentários gerais**\r\n\r\nApesar dos dois mapeamentos apresentarem resultados similares, o mapeamento por intervalo composto apresenta resultados mais \"refinados\" para cada intervalo permitindo uma abordagem mais acurada do mapeamento e consequentemente, da identificação de regiões associadas as características quantitativas.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}